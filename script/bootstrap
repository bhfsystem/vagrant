#!/usr/bin/env bash

function bootstrap {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"
  source "$shome/script/profile"

  git clone git@github.com:mitchellh/vagrant "$shome/vendor/vagrant" 2>/dev/null || true
  (cd "$shome/vendor/vagrant" && git fetch && git reset --hard "v${VAGRANT_VERSION}")
  (cd "$shome/vendor/vagrant" && echo gem '"mini_portile2"' >> Gemfile)
  (cd "$shome/vendor/vagrant" && echo gem '"vagrant-aws"' >> Gemfile)
  (cd "$shome/vendor/vagrant" && block compile bundler)
}

bootstrap
